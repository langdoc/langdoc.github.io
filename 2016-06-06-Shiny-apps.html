<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Niko Partanen" />


<title>Simple Shiny app for searching corpus data</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="site_libs/highlight/textmate.css"
      type="text/css" />
<script src="site_libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="site_libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">



<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <!-- NOTE: add "navbar-inverse" class for an alternate navbar background -->
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Language Documentation</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="old.html">All Texts</a></li>
<!-- These come back later
           <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Subpages</a>
                <ul class="dropdown-menu">
            <li><a href="http://izvakomi.github.io/">Iźva Komi Documentation Project</a></li>
            <li><a href="http://langdoc.github.io/downrivervashka">Down River Vashka</a></li>
            <li><a href="http://nikopartanen.github.io/sle2016partanen">Niko Partanen's SLE 2016 paper</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">Micha's conference page</a></li>
            <li role="separator" class="divider"></li>
            <li><a href="#">One more separated link</a></li>
          </ul>
        </li> -->
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="https://github.com/langdoc">GitHub</a></li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Simple Shiny app for searching corpus data</h1>
<h4 class="author"><em>Niko Partanen</em></h4>

</div>


<p>In the earlier blog post I went through quite extensible and easy way to parse ELAN files into R. Of course the question <strong>what is this good for?</strong> has not yet been properly answered. I understand some people are reluctant to use R as it doesn’t really have any user interface. Late developments with Shiny web application framework is good answer to this, since it offers only not an user interface, it is also dead simple to set up.</p>
<p>On Shiny website it is advertised with idea that no HTML or JavaScript are required. Well, this is a half-truth in my opinion. To do some really fancy things one certainly needs to know more than just R – but actually knowing only that is already a good start. Maybe one problem is that as linguists we may come up with all kind of wishes which aren’t exactly in the mainstream in wider framework where these things are developed.</p>
<p>But let’s not talk about the problems but about what we can do.</p>
<p>The earlier post ended into parsing of one ELAN file. Let’s continue with that.</p>
<div id="keyword-in-context" class="section level3">
<h3>Keyword in context</h3>
<p>In <code>FRelan</code> package there is a function <code>add_kwic()</code> which adds columns needed for classic Key Word in Context -type of view.</p>
<pre class="r"><code>eaf &lt;- eaf %&gt;% FRelan::add_kwic()
eaf %&gt;% dplyr::select(before, token, after, session_name, participant) %&gt;% slice(1:10) %&gt;% knitr::kable(align = c(&quot;r&quot;, &quot;c&quot;, &quot;l&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="right">before</th>
<th align="center">token</th>
<th align="left">after</th>
<th align="right">session_name</th>
<th align="center">participant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"></td>
<td align="center">пожняысь</td>
<td align="left">, пожня , пожня , пожня сиктысь , да</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="even">
<td align="right">пожняысь</td>
<td align="center">,</td>
<td align="left">пожня , пожня , пожня сиктысь , да .</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="odd">
<td align="right">пожняысь ,</td>
<td align="center">пожня</td>
<td align="left">, пожня , пожня сиктысь , да . да</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="even">
<td align="right">пожняысь , пожня</td>
<td align="center">,</td>
<td align="left">пожня , пожня сиктысь , да . да ,</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="odd">
<td align="right">пожняысь , пожня ,</td>
<td align="center">пожня</td>
<td align="left">, пожня сиктысь , да . да , уджалі</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="even">
<td align="right">пожняысь , пожня , пожня</td>
<td align="center">,</td>
<td align="left">пожня сиктысь , да . да , уджалі .</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="odd">
<td align="right">пожняысь , пожня , пожня ,</td>
<td align="center">пожня</td>
<td align="left">сиктысь , да . да , уджалі . сійӧ</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="even">
<td align="right">пожняысь , пожня , пожня , пожня</td>
<td align="center">сиктысь</td>
<td align="left">, да . да , уджалі . сійӧ вӧлі</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="odd">
<td align="right">пожняысь , пожня , пожня , пожня сиктысь</td>
<td align="center">,</td>
<td align="left">да . да , уджалі . сійӧ вӧлі квайтымын</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
<tr class="even">
<td align="right">пожняысь , пожня , пожня , пожня сиктысь ,</td>
<td align="center">да</td>
<td align="left">. да , уджалі . сійӧ вӧлі квайтымын ӧтикӧд</td>
<td align="right">kpv_izva20140404IgusevJA-b</td>
<td align="center">JAI-M-1939</td>
</tr>
</tbody>
</table>
<p>This already starts to remind an environment where one can make searches. For this there are two very simple functions, <code>find_token()</code> and <code>exc_token()</code>. They take regular expressions, and the idea is that one can just pipe them as needed. They are basically just shorthands for <code>filter(grepl(&quot;regex&quot;, token)</code> but with less typing.</p>
</div>
<div id="searches-with-shiny" class="section level3">
<h3>Searches with Shiny</h3>
<p>Shiny framework allows very easy creation of web applications.</p>
<pre class="r"><code>eaf %&gt;% FRorpus()</code></pre>
<p>This opens an application like this:</p>
<div class="figure">
<img src="media/images/FRorpus_start.png" alt="FRorpus Shiny application" />
<p class="caption">FRorpus Shiny application</p>
</div>
<p>The searches can be refined more either before or after starting the application:</p>
<div class="figure">
<img src="media/images/FRorpus_example_ig.png" alt="Searching Komi gerunds" />
<p class="caption">Searching Komi gerunds</p>
</div>
</div>
<div id="frorpus-code" class="section level3">
<h3>FRorpus code</h3>
<pre class="r"><code>FRelan::FRorpus</code></pre>
<pre><code>## function(corpus, c1 = &quot;before&quot;, c2 = &quot;token&quot;, c3 = &quot;after&quot;, c4 = FALSE) {
## 
## `%&gt;%` &lt;- dplyr::`%&gt;%`
## 
## data &lt;- corpus
## 
## # This is the function used to filter searches
## 
## filtering &lt;- function(regex, env_after, env_before, ignore){
##         data &lt;- data %&gt;% dplyr::filter(grepl(regex, token, perl = TRUE))
##         data &lt;- data %&gt;% dplyr::filter(grepl(env_after, after, perl = TRUE))
##         data &lt;- data %&gt;% dplyr::filter(grepl(env_before, before, perl = TRUE))
##         data &lt;- data %&gt;% dplyr::filter(! grepl(ignore, token, perl = TRUE))
## }
## 
## # This is the UI definition
## 
## shiny::shinyApp(ui = shiny::fluidPage(theme = &quot;bootstrap.css&quot;,
##         shiny::navbarPage(
##                 title = &#39;FRorpus&#39;,
##                         shiny::tabPanel(&#39;Concordances&#39;,
## 
##                                 shiny::tags$head(shiny::tags$style(&quot;.table .alignRight {color: black; text-align:right;}&quot;)),
##                                 shiny::tags$head(shiny::tags$style(&quot;.table .alignCenter {color: blue; text-align:center;}&quot;)),
##                                 shiny::tags$head(shiny::tags$style(&quot;.table .alignLeft {color: black; text-align:left;}&quot;)),
## 
## # There are the inputs
## 
##                         shiny::fluidRow(
##                                 shiny::column(3,
##                                               shiny::textInput(&quot;text3&quot;, label = shiny::h4(&quot;Over left border:&quot;), value = &quot;^.+$&quot;)),
##                                 shiny::column(3,
##                                               shiny::textInput(&quot;text1&quot;, label = shiny::h4(&quot;Search tokens:&quot;), value = &quot;^.+$&quot;)),
##                                 shiny::column(3,
##                                               shiny::textInput(&quot;text2&quot;, label = shiny::h4(&quot;Over right border:&quot;), value = &quot;^.+$&quot;)),
##                                 shiny::column(3,
##                                               shiny::textInput(&quot;text4&quot;, label = shiny::h4(&quot;Ignore:&quot;), value = &quot;$nothing&quot;)),
## 
## # This is the table for results
## 
##                         shiny::fluidRow(shiny::dataTableOutput(outputId=&quot;table&quot;)
##                                                    ))
## ),
## 
## # This is another tab for different content -- there could be more of these
## 
##                         shiny::tabPanel(&#39;Information &amp; Help&#39;,
##                                  (shiny::fluidPage(
##                                          shiny::h1(&quot;FRorpus application&quot;),
##                                          shiny::p(paste0(&quot;This search interface is designed to be used within FRelan R package and is integrated into it.&quot;)),
##                                          shiny::p(&quot;The regular expressions have to be used in the searches. They are Perl compatible.&quot;)
##                                  ))
## ),
## 
## # Just contact information
## 
##                         shiny::tabPanel(&#39;Contact&#39;,
##                                 (shiny::fluidPage(shiny::h1(&quot;Freiburg Research Group in Saami Studies&quot;),
##                                                   shiny::p(&quot;Please contact Niko Partanen (nikotapiopartanen@gmail.com) or Michael Rießler (michael.riessler@skandinavistik.uni-freiburg.de).&quot;)
##                                            )))
##                           )
##                 ),
## # This is the server file. It is often as its own file, but can be also within the same file as it is here.
## 
## server = function(input, output) {
## 
##         # Filter data based on selections
## 
##         output$table &lt;- shiny::renderDataTable({
## 
##                 data &lt;- filtering(input$text1, input$text2, input$text3, input$text4)
## 
##                  if (c4 == FALSE){
##                 data[,c(c1, c2, c3)]
##                  } else {
##                 data[,c(c1, c2, c3, c4)]
##                  }
## 
##         }, options = list(
## 
##                 # These are the column settings
## 
##                 aoColumnDefs = list(
##                         list(targets = c(0, 1, 2), searchable = FALSE),
##                         list(sClass=&quot;alignRight&quot;, aTargets=c(0)),
##                         list(sClass=&quot;alignCenter&quot;, aTargets=c(1)),
##                         list(sClass=&quot;alignLeft&quot;, aTargets=c(2)),
##                         list(sWidth=c(&quot;200px&quot;), aTargets=c(0)),
##                         list(sWidth=c(&quot;100px&quot;), aTargets=c(1)),
##                         list(sWidth=c(&quot;200px&quot;), aTargets=c(2))
##                 ),
## 
##                 # These are data table settings
## 
##                 searching = 0,  # global search box on/off
##                 lengthMenu = c(10, 50, 100), # length options
##                 pageLength = 20) # default rows
##         )
## })
## }
## &lt;environment: namespace:FRelan&gt;</code></pre>
<div id="refs" class="references">

</div>
</div>

<hr>
<p>Copyright &copy; 2016 CC-BY Niko Partanen or individual writers.</p>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
